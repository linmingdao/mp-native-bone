<view class="fix_top search_btn_area">
  <input data-contentType="filterText" adjust-position="true" value="{{filterText}}" bindinput="bindUserInput" class="search_input" type="text" placeholder="输入团队名称进行搜索" placeholder-class="placeholder" />
  <view wx:if="{{filterText !== ''}}" class="cancel_btn" bindtap="cancelSearch"></view>
</view>
<view class="container">
  <!-- 关系 -->
  <view wx:if="{{filterText === ''}}">
    <view class="tab" bindtap="switchRelTab">
      <view data-name="contact" class="tab_item{{relVisibleTab === 'contact' ? ' check' : ''}}">
        <image class="icon" src="/assets/images/team_chain.png" />
        <view class="text">团队链</view>
      </view>
      <view data-name="join" class="tab_item{{relVisibleTab === 'join' ? ' check' : ''}}">
        <image class="icon" src="/assets/images/joined.png" />
        <view class="text">加入的</view>
      </view>
      <view data-name="concern" class="tab_item{{relVisibleTab === 'concern' ? ' check' : ''}}">
        <image class="icon" src="/assets/images/concerned.png" />
        <view class="text">关注的</view>
      </view>
    </view>
    <!-- 关系列表 -->
    <view wx:if="{{relVisibleTab === 'contact'}}" class="accordion_box">
      <view class="accordion_item">
        <view class="title{{expandContactIdx === 0?' pulldown':''}}" data-expandidx="{{0}}" catchtap="expand">
          <text>上行</text>
        </view>
        <view wx:if="{{expandContactIdx === 0}}">
          <view class="rel_list">
            <view class="rel_item" wx:for="{{superior}}" wx:for-index="index" wx:for-item="item">
              <view wx:if="{{role === 'admin'}}" class="team_opertator">
                <view wx:if="{{item.todoAudit === 1}}" class="opertator_btn accept img-icon icon-confirm--white_tick" catchtap="acceptRelationRequest" data-type="superior" data-index="{{index}}" data-msgid="{{item.msgId}}"></view>
                <view wx:if="{{item.todoAudit === 0}}" class="opertator_btn delete img-icon icon-delete--white_trash" catchtap="deleteRelation" data-type="superior" data-index="{{index}}" data-id="{{item._id}}"></view>
              </view>
              <view class="team_content" catchtap="switchTeam" bindlongpress="rejectRelationRequest" bindtouchend="touchend" data-todoaudit="{{item.todoAudit}}" data-type="superior" data-index="{{index}}" data-msgid="{{item.msgId}}" data-tid="{{item._id}}">
                <image class="avatar" src="{{item.team_logo}}"></image>
                <view class="text_area">
                  <view class="usr_name">{{item.name}}</view>
                  <view class="req_text">创建者: {{item.mid.name}}</view>
                </view>
              </view>
            </view>
          </view>
          <view wx:if="{{role === 'admin'}}" catchtap="go2TeamSelector" data-level="superior" class="add_relation_btn img-icon icon-add--white_plus"></view>
        </view>
      </view>
      <view class="accordion_item">
        <view class="title{{expandContactIdx === 1?' pulldown':''}}" data-expandidx="{{1}}" bindtap="expand">
          <text>平行</text>
        </view>
        <view wx:if="{{expandContactIdx === 1}}">
          <view class="rel_list">
            <view class="rel_item" wx:for="{{parallel}}" wx:for-index="index" wx:for-item="item">
              <view wx:if="{{role === 'admin'}}" class="team_opertator">
                <view wx:if="{{item.todoAudit === 1}}" class="opertator_btn accept img-icon icon-confirm--white_tick" catchtap="acceptRelationRequest" data-type="parallel" data-index="{{index}}" data-msgid="{{item.msgId}}"></view>
                <view wx:if="{{item.todoAudit === 0}}" class="opertator_btn delete img-icon icon-delete--white_trash" catchtap="deleteRelation" data-type="parallel" data-index="{{index}}" data-id="{{item._id}}"></view>
              </view>
              <view class="team_content" bindtap="switchTeam" bindlongpress="rejectRelationRequest" bindtouchend="touchend" data-todoaudit="{{item.todoAudit}}" data-type="parallel" data-index="{{index}}" data-msgid="{{item.msgId}}" data-tid="{{item._id}}">
                <image class="avatar" src="{{item.team_logo}}"></image>
                <view class="text_area">
                  <view class="usr_name">{{item.name}}</view>
                  <view class="req_text">创建者: {{item.mid.name}}</view>
                </view>
              </view>
            </view>
          </view>
          <view wx:if="{{role === 'admin'}}" bindtap="go2TeamSelector" data-level="parallel" class="add_relation_btn img-icon icon-add--white_plus"></view>
        </view>
      </view>
      <view class="accordion_item">
        <view class="title{{expandContactIdx === 2?' pulldown':''}}" data-expandidx="{{2}}" bindtap="expand">
          <text>下行</text>
        </view>
        <view wx:if="{{expandContactIdx === 2}}">
          <view class="rel_list">
            <view class="rel_item" wx:for="{{subordinate}}" wx:for-index="index" wx:for-item="item">
              <view wx:if="{{role === 'admin'}}" class="team_opertator">
                <view wx:if="{{item.todoAudit === 1}}" class="opertator_btn accept img-icon icon-confirm--white_tick" catchtap="acceptRelationRequest" data-type="subordinate" data-index="{{index}}" data-msgid="{{item.msgId}}"></view>
                <view wx:if="{{item.todoAudit === 0}}" class="opertator_btn delete img-icon icon-delete--white_trash" catchtap="deleteRelation" data-type="subordinate" data-index="{{index}}" data-id="{{item._id}}"></view>
              </view>
              <view class="team_content" bindtap="switchTeam" bindlongpress="rejectRelationRequest" bindtouchend="touchend" data-todoaudit="{{item.todoAudit}}" data-type="subordinate" data-index="{{index}}" data-msgid="{{item.msgId}}" data-tid="{{item._id}}">
                <image class="avatar" src="{{item.team_logo}}"></image>
                <view class="text_area">
                  <view class="usr_name">{{item.name}}</view>
                  <view class="req_text">创建者: {{item.mid.name}}</view>
                </view>
              </view>
            </view>
          </view>
          <view wx:if="{{role === 'admin'}}" bindtap="go2TeamSelector" data-level="subordinate" class="add_relation_btn img-icon icon-add--white_plus"></view>
        </view>
      </view>
    </view>
    <view wx:if="{{relVisibleTab === 'join'}}" class="tab_box_detail">
      <view bindtap="switchTeam" wx:key="{{index}}" data-tid="{{item._id}}" wx:for="{{join}}" wx:for-item="item">
        <view class="left">
          <image style="border-radius:10rpx;" src="{{item.team_logo}}"></image>
        </view>
        <view class="right">
          <view>
            <view class="name">{{item.name}}</view>
            <view class="info">
              <view>创建者: {{item.mid.name}}</view>
              <view>地址：{{item.province}}{{item.city}}{{item.area}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>
    <view wx:if="{{relVisibleTab === 'concern'}}" class="tab_box_detail">
      <view bindtap="switchTeam" wx:key="{{index}}" data-tid="{{item._id}}" wx:for="{{concern}}" wx:for-item="item">
        <view class="left">
          <image style="border-radius:10rpx;" src="{{item.team_logo}}"></image>
        </view>
        <view class="right">
          <view>
            <view class="name">{{item.name}}</view>
            <view class="info">
              <view>创建者: {{item.mid.name}}</view>
              <view>地址：{{item.province}}{{item.city}}{{item.area}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
  <!-- 搜索结果 -->
  <view wx:if="{{filterText !== ''}}" class="tab_box_detail">
    <view bindtap="switchTeamFromSearchResult" wx:key="{{index}}" data-tid="{{item._id}}" wx:for="{{searchTeamList}}" wx:for-item="item">
      <view class="left">
        <image style="border-radius:10rpx;" src="{{item.team_logo}}"></image>
      </view>
      <view class="right">
        <view>
          <view class="name">{{item.name}}</view>
          <view class="info">
            <view>创建者: {{item.mid.name}}</view>
            <view>地址：{{item.province}}{{item.city}}{{item.area}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>